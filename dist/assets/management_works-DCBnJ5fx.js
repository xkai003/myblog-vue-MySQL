import{a as c}from"./index-B9ygI19o.js";import{_ as m,c as g,a as e,w as a,h as f,i as b,j as k,v as d,t as p,F as v,r as _,k as x,o as w,f as y}from"./index-DLLBHxZI.js";const S={data(){return{title:"",label:"",technology:"",worklist:[],isshow:!1,edittitle:"",editlabel:"",edittechnology:"",selectedId:null}},methods:{async submit(){const o=function(){const s=new Date,i=s.getFullYear(),n=String(s.getMonth()+1).padStart(2,"0"),r=String(s.getDate()).padStart(2,"0"),u=String(s.getHours()).padStart(2,"0"),l=String(s.getMinutes()).padStart(2,"0"),h=String(s.getSeconds()).padStart(2,"0");return`${i}-${n}-${r} ${u}:${l}:${h}`},t={id:Date.now(),title:this.title,label:this.label,time:o(),look:"5",technology:this.technology};if(!t.id||!t.title||!t.label||!t.technology){alert("请填写作品信息！");return}try{const s=await c.post("http://47.79.40.65:3006/works",t);if(s.status===201)alert("添加作品成功！"),location.reload();else try{const i=s.data;alert(`添加失败: ${i.error||"未知错误"}. 详细信息: ${i.details||"无"}`)}catch{alert(`添加失败，但无法解析错误信息。状态码：${s.status}`)}}catch{}},reset(){this.title="",this.label="",this.technology=""},async del(o){if(!o)return;if(confirm("确定要删除该作品吗？"))try{const s=`http://47.79.40.65:3006/works/${o}`,i=await c.delete(s);i.status===200?(alert("删除成功！"),location.reload()):alert(`删除失败: ${i.data.error||"未知错误"}`)}catch(s){alert("删除数据失败，请检查网络。"),console.error(s)}},edit(o){this.isshow=!0,this.selectedId=o.id,this.edittitle=o.title,this.editlabel=o.label,this.edittechnology=o.technology},async editsubmit(){if(!this.selectedId){alert("请先选择要修改的作品");return}try{const o=`http://47.79.40.65:3006/works/${this.selectedId}`,t=await c.put(o,{title:this.edittitle,label:this.editlabel,technology:this.edittechnology});t.status===200?(alert("修改成功！"),this.isshow=!1,location.reload()):alert(`修改失败: ${t.data.error||"未知错误"}`)}catch{}}},async created(){try{const o=await c.get("http://47.79.40.65:3006");console.log("后端数据：",o.data),o.data&&o.data.works?this.worklist=o.data.works.sort((t,s)=>{const i=new Date(t.time);return new Date(s.time)-i}):console.warn("后端返回的数据格式不正确，缺少 'works' 字段")}catch(o){console.error("请求失败:",o)}}},C={class:"box"},D={class:"center"},V={class:"form"},U={class:"nav"},B={class:"title"},I={class:"label"},M={class:"technology"},Y={class:"btn"},F={class:"food"},H={class:"worklist"},N={class:"workstable"},T=["onClick"],$=["onClick"],E={class:"edit"},j={class:"edit-form"},A={class:"title"},L={class:"label"},W={class:"technology"},q={class:"btn"};function z(o,t,s,i,n,r){const u=k("router-link");return w(),g("div",C,[e("div",D,[e("div",V,[e("div",U,[f(u,{to:"/management_works",style:{color:"#fff","background-color":"#60cdf8"}},{default:b(()=>[...t[10]||(t[10]=[y("作品",-1)])]),_:1}),f(u,{to:"/management_notes"},{default:b(()=>[...t[11]||(t[11]=[y("笔记",-1)])]),_:1}),f(u,{to:"/management_travel"},{default:b(()=>[...t[12]||(t[12]=[y("旅游",-1)])]),_:1})]),e("div",B,[t[13]||(t[13]=e("span",null,"标题：",-1)),a(e("input",{type:"text",placeholder:"请输入标题(不超过45字)","onUpdate:modelValue":t[0]||(t[0]=l=>n.title=l)},null,512),[[d,n.title]])]),e("div",I,[t[14]||(t[14]=e("span",null,"链接：",-1)),a(e("input",{type:"text",placeholder:"请输入链接(不超过300字)","onUpdate:modelValue":t[1]||(t[1]=l=>n.label=l)},null,512),[[d,n.label]])]),e("div",M,[t[15]||(t[15]=e("span",null,"技术栈：",-1)),a(e("textarea",{placeholder:"请输入技术栈(不超过300字)","onUpdate:modelValue":t[2]||(t[2]=l=>n.technology=l)},null,512),[[d,n.technology]])]),e("div",Y,[e("button",{onClick:t[3]||(t[3]=l=>r.submit())},"提交"),e("button",{onClick:t[4]||(t[4]=l=>r.reset())},"重置")])]),e("div",F,[e("p",null,"作品列表（"+p(n.worklist.length)+"）",1),e("div",H,[t[16]||(t[16]=e("ul",null,[e("li",null,"标题"),e("li",null,"链接"),e("li",null,"技术栈"),e("li",null,"操作")],-1)),e("div",N,[(w(!0),g(v,null,_(n.worklist,l=>(w(),g("ul",{key:l.id},[e("li",null,p(l.title),1),e("li",null,p(l.label),1),e("li",null,p(l.technology),1),e("li",null,[e("button",{onClick:h=>r.edit(l)},"编辑",8,T),e("button",{onClick:h=>r.del(l.id)},"删除",8,$)])]))),128))])])]),a(e("div",E,[e("div",j,[t[20]||(t[20]=e("h3",null,"编辑作品",-1)),e("div",A,[t[17]||(t[17]=e("span",null,"标题：",-1)),a(e("input",{type:"text",placeholder:"请输入标题(不超过45字)","onUpdate:modelValue":t[5]||(t[5]=l=>n.edittitle=l)},null,512),[[d,n.edittitle]])]),e("div",L,[t[18]||(t[18]=e("span",null,"链接：",-1)),a(e("input",{type:"text",placeholder:"请输入链接(不超过45字)","onUpdate:modelValue":t[6]||(t[6]=l=>n.editlabel=l)},null,512),[[d,n.editlabel]])]),e("div",W,[t[19]||(t[19]=e("span",null,"技术栈：",-1)),a(e("textarea",{placeholder:"请输入技术栈(不超过45字)","onUpdate:modelValue":t[7]||(t[7]=l=>n.edittechnology=l)},null,512),[[d,n.edittechnology]])]),e("div",q,[e("button",{onClick:t[8]||(t[8]=l=>r.editsubmit())},"提交"),e("button",{onClick:t[9]||(t[9]=l=>this.isshow=!1)},"取消")])])],512),[[x,n.isshow]])])])}const K=m(S,[["render",z],["__scopeId","data-v-bcfcb9fd"]]);export{K as default};
