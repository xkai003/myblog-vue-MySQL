import{a as c}from"./index-B9ygI19o.js";import{_ as y,c as v,a as e,w as r,h as g,i as f,j as k,v as a,t as p,F as x,r as b,k as S,o as h,f as w}from"./index-DLLBHxZI.js";const _={data(){return{name:"",location:"",image:"",description:"",travellist:[],isshow:!1,editname:"",editlocation:"",editimage:"",editdescription:"",selectedId:null}},methods:{async submit(){const i=function(){const n=new Date,l=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),d=String(n.getDate()).padStart(2,"0"),u=String(n.getHours()).padStart(2,"0"),s=String(n.getMinutes()).padStart(2,"0"),m=String(n.getSeconds()).padStart(2,"0");return`${l}-${o}-${d} ${u}:${s}:${m}`},t={id:Date.now(),name:this.name,location:this.location,time:i(),look:"5",image:this.image,description:this.description};if(!t.id||!t.name||!t.location||!t.image||!this.description){alert("请填写所有课程信息！");return}try{const n=await c.post("http://47.79.40.65:3006/travel",t);if(n.status===201)alert("添加旅游成功！"),location.reload();else try{const l=n.data;alert(`添加失败: ${l.error||"未知错误"}. 详细信息: ${l.details||"无"}`)}catch{alert(`添加失败，但无法解析错误信息。状态码：${n.status}`)}}catch{}},reset(){this.name="",this.location="",this.image="",this.description="",this.editdescription=""},async del(i){if(!i)return;if(confirm("确定要删除该旅游吗？"))try{const n=`http://47.79.40.65:3006/travel/${i}`,l=await c.delete(n);l.status===200?(alert("删除成功！"),location.reload()):alert(`删除失败: ${l.data.error||"未知错误"}`)}catch(n){alert("删除数据失败，请检查网络。"),console.error(n)}},edit(i){this.isshow=!0,this.selectedId=i.id,this.editname=i.name,this.editlocation=i.location,this.editimage=i.image,this.editdescription=i.description},async editsubmit(){if(!this.selectedId){alert("请先选择要修改的旅游");return}try{const i=`http://47.79.40.65:3006/travel/${this.selectedId}`,t=await c.put(i,{name:this.editname,location:this.editlocation,image:this.editimage,description:this.editdescription});t.status===200?(alert("修改成功！"),this.isshow=!1,location.reload()):alert(`修改失败: ${t.data.error||"未知错误"}`)}catch{}}},async created(){try{const i=await c.get("http://47.79.40.65:3006");console.log("后端数据：",i.data),i.data&&i.data.travel?this.travellist=i.data.travel.sort((t,n)=>{const l=new Date(t.time);return new Date(n.time)-l}):console.warn("后端返回的数据格式不正确，缺少 'travel' 字段")}catch(i){console.error("请求失败:",i)}}},V={class:"box"},C={class:"center"},D={class:"form"},U={class:"nav"},B={class:"name"},I={class:"location"},M={class:"image"},Y={class:"description"},F={class:"btn"},H={class:"food"},N={class:"travellist"},T={class:"travetable"},E=["onClick"],j=["onClick"],A={class:"edit"},L={class:"edit-form"},q={class:"name"},z={class:"location"},G={class:"image"},J={class:"description"},K={class:"btn"};function O(i,t,n,l,o,d){const u=k("router-link");return h(),v("div",V,[e("div",C,[e("div",D,[e("div",U,[g(u,{to:"/management_works"},{default:f(()=>[...t[12]||(t[12]=[w("作品",-1)])]),_:1}),g(u,{to:"/management_notes"},{default:f(()=>[...t[13]||(t[13]=[w("笔记",-1)])]),_:1}),g(u,{to:"/management_travel",style:{color:"#fff","background-color":"#60cdf8"}},{default:f(()=>[...t[14]||(t[14]=[w("旅游",-1)])]),_:1})]),e("div",B,[t[15]||(t[15]=e("span",null,"标题：",-1)),r(e("input",{type:"text",placeholder:"请输入标题(不超过45字)","onUpdate:modelValue":t[0]||(t[0]=s=>o.name=s)},null,512),[[a,o.name]])]),e("div",I,[t[16]||(t[16]=e("span",null,"地点：",-1)),r(e("input",{type:"text",placeholder:"请输入地点(不超过45字)","onUpdate:modelValue":t[1]||(t[1]=s=>o.location=s)},null,512),[[a,o.location]])]),e("div",M,[t[17]||(t[17]=e("span",null,"图片：",-1)),r(e("input",{type:"text",placeholder:"请输入图片(不超过300字)","onUpdate:modelValue":t[2]||(t[2]=s=>o.image=s)},null,512),[[a,o.image]])]),e("div",Y,[t[18]||(t[18]=e("span",null,"描述：",-1)),r(e("textarea",{placeholder:"请输入描述(不超过300字)","onUpdate:modelValue":t[3]||(t[3]=s=>o.description=s)},null,512),[[a,o.description]])]),e("div",F,[e("button",{onClick:t[4]||(t[4]=s=>d.submit())},"提交"),e("button",{onClick:t[5]||(t[5]=s=>d.reset())},"重置")])]),e("div",H,[e("p",null,"旅游列表（"+p(o.travellist.length)+"）",1),e("div",N,[t[19]||(t[19]=e("ul",null,[e("li",null,"标题"),e("li",null,"地点"),e("li",null,"图片"),e("li",null,"描述"),e("li",null,"操作")],-1)),e("div",T,[(h(!0),v(x,null,b(o.travellist,s=>(h(),v("ul",{key:s.id},[e("li",null,p(s.name),1),e("li",null,p(s.location),1),e("li",null,p(s.image),1),e("li",null,p(s.description),1),e("li",null,[e("button",{onClick:m=>d.edit(s)},"编辑",8,E),e("button",{onClick:m=>d.del(s.id)},"删除",8,j)])]))),128))])])]),r(e("div",A,[e("div",L,[t[24]||(t[24]=e("h3",null,"编辑旅游",-1)),e("div",q,[t[20]||(t[20]=e("span",null,"标题：",-1)),r(e("input",{type:"text",placeholder:"请输入标题(不超过45字)","onUpdate:modelValue":t[6]||(t[6]=s=>o.editname=s)},null,512),[[a,o.editname]])]),e("div",z,[t[21]||(t[21]=e("span",null,"地点：",-1)),r(e("input",{type:"text",placeholder:"请输入地点(不超过45字)","onUpdate:modelValue":t[7]||(t[7]=s=>o.editlocation=s)},null,512),[[a,o.editlocation]])]),e("div",G,[t[22]||(t[22]=e("span",null,"图片：",-1)),r(e("input",{type:"text",placeholder:"请输入图片链接(不超过45字)","onUpdate:modelValue":t[8]||(t[8]=s=>o.editimage=s)},null,512),[[a,o.editimage]])]),e("div",J,[t[23]||(t[23]=e("span",null,"描述：",-1)),r(e("textarea",{placeholder:"请输入描述(不超过45字)","onUpdate:modelValue":t[9]||(t[9]=s=>o.editdescription=s)},null,512),[[a,o.editdescription]])]),e("div",K,[e("button",{onClick:t[10]||(t[10]=s=>d.editsubmit())},"提交"),e("button",{onClick:t[11]||(t[11]=s=>this.isshow=!1)},"取消")])])],512),[[S,o.isshow]])])])}const R=y(_,[["render",O],["__scopeId","data-v-2f4662f5"]]);export{R as default};
